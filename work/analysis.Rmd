---
title: "analysis"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
#Load data
Instruments <- read_csv("/home/samaebius/group-4/data/Instruments.csv")

Instruments<-Instruments%>%
  mutate(instrument=case_when(
    substr(FileName, 1, 4)=="Flut"~"Flute",
    substr(FileName, 1, 4)=="Guit"~"Guitar",
    substr(FileName, 1, 4)=="Mand"~"Mandolin",
    substr(FileName, 1, 4)=="Pian"~"Piano",
    substr(FileName, 1, 4)=="Ukul"~"Ukulele",
    substr(FileName, 1, 4)=="Viol"~"Violin"
  ))

#Test and train data


#Correlation matrix
corr <- cor(Instruments[-c(1:2, 18)])
corr

#Conclusion: Drop DecayDetermination, FundamentalStrengthRatio, RMSE2, RMSE3
```

```{r}
library(MASS)
#Linear Discriminant Analysis

sub_instrument <- subset(Instruments, select = -c(X1, FileName, DecayDetermination, DecaySignificance, FundamentalStrengthRatio, RMSE2, RMSE3, RMSE1, r_squared1, r_squared2, r_squared3))

lda <- lda(instrument ~ ., data = sub_instrument, family = multinomial)
lda


#Misclassification rate

lda_yhat<-predict(lda, type="response")
INSTRUMENTS<-c("Flute", "Guitar", "Mandolin", "Piano", "Ukulele", "Violin")
predicted1 <- INSTRUMENTS[apply(lda_yhat, 1, which.max)]
conf_mat1 <- table(predicted1, Instruments$instrument)
conf_mat1
MisclassRate1<-1-sum(diag(conf_mat1))/nrow(Instruments)
MisclassRate1
IndividualMisclassRates1<-rep(NA, 6)
for (i in 1:6){
  Predictions<-conf_mat1[,i]
  NumberPredictions<-sum(Predictions)
  NumberIncorrect<-sum(Predictions[-i])
  IndividualMisclassRates1[i]<-NumberIncorrect/NumberPredictions
}
IndividualMisclassrates1<-data.frame(IndividualMisclassRates1)
`rownames<-`(IndividualMisclassrates1, INSTRUMENTS)


```

```{r}
qda <- qda(instrument ~ ., data = sub_instrument, family = multinomial)
qda

#Misclassification rate

qda_yhat<-predict(boost, type="response", n.trees=50)
INSTRUMENTS<-c("Flute", "Guitar", "Mandolin", "Piano", "Ukulele", "Violin")
predicted2 <- INSTRUMENTS[apply(qda_yhat, 1, which.max)]
conf_mat2 <- table(predicted2, Instruments$instrument)
conf_mat2
MisclassRate2<-1-sum(diag(conf_mat2))/nrow(Instruments)
MisclassRate2
IndividualMisclassRates2<-rep(NA, 6)
for (i in 1:6){
  Predictions<-conf_mat2[,i]
  NumberPredictions<-sum(Predictions)
  NumberIncorrect<-sum(Predictions[-i])
  IndividualMisclassRates2[i]<-NumberIncorrect/NumberPredictions
}
IndividualMisclassrates2<-data.frame(IndividualMisclassRates2)
`rownames<-`(IndividualMisclassrates2, INSTRUMENTS)
```

```{r}
#boosted tree
library(gbm)

sub_instrument <- na.omit(sub_instrument)

set.seed(1)
boost <- gbm(instrument ~., data = sub_instrument, n.trees = 50, interaction.depth = 1, shrinkage = 0.1, distribution = "multinomial")

#Misclassification rate

boost_yhat<-predict(boost, type="response", n.trees=50)
INSTRUMENTS<-c("Flute", "Guitar", "Mandolin", "Piano", "Ukulele", "Violin")
predicted3 <- INSTRUMENTS[apply(boost_yhat, 1, which.max)]
conf_mat3 <- table(predicted3, Instruments$instrument)
conf_mat3
MisclassRate3<-1-sum(diag(conf_mat3))/nrow(Instruments)
MisclassRate3
IndividualMisclassRates3<-rep(NA, 6)
for (i in 1:6){
  Predictions<-conf_mat3[,i]
  NumberPredictions<-sum(Predictions)
  NumberIncorrect<-sum(Predictions[-i])
  IndividualMisclassRates3[i]<-NumberIncorrect/NumberPredictions
}
IndividualMisclassrates3<-data.frame(IndividualMisclassRates3)
`rownames<-`(IndividualMisclassrates3, INSTRUMENTS)



#Note: removed 3 observations with NAs
```

```{r}
#boosted tree with more variables (possible collinearity)

sub_instrument1 <- subset(Instruments, select = -c(X1, FileName, DecayDetermination, FundamentalStrengthRatio, RMSE2, RMSE3, r_squared2, r_squared3))
sub_instrument1 <- na.omit(sub_instrument1)

set.seed(1)
boost2 <- gbm(instrument ~., data = sub_instrument1, n.trees = 50, interaction.depth = 1, shrinkage = 0.1, distribution = "multinomial")

#Misclassification rate

boost_yhat2<-predict(boost2, type="response", n.trees=50)
predicted4 <- INSTRUMENTS[apply(boost_yhat2, 1, which.max)]
conf_mat4 <- table(predicted4, Instruments$instrument)
conf_mat4
MisclassRate4<-1-sum(diag(conf_mat4))/nrow(Instruments)
MisclassRate4
IndividualMisclassRates4<-rep(NA, 6)
for (i in 1:6){
  Predictions<-conf_mat4[,i]
  NumberPredictions<-sum(Predictions)
  NumberIncorrect<-sum(Predictions[-i])
  IndividualMisclassRates4[i]<-NumberIncorrect/NumberPredictions
}
IndividualMisclassrates4<-data.frame(IndividualMisclassRates4)
`rownames<-`(IndividualMisclassRates4, INSTRUMENTS)
```


```{r}
#pca

```

